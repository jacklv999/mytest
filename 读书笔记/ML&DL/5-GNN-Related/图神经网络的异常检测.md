# 图神经网络的异常检测

#### 背景与挑战

异常检测是数据挖掘的经典任务之一。分析异常数据有助于企业或用户理解其背后的形成机制，从而做出相应决策，避免损失。随着网络发展，面向结构化数据的异常检测，即图异常检测，受到越来越多关注。

图异常检测具体可定义为：寻找图上的少部分对象（节点、边、子图等），它们与其余大多数对象有着不同分布规律。**本文专注于图上异常节点的检测任务**。相较于传统的异常检测方法，图异常检测能够利用不同实体之间的关联信息，更好服务于网络安全、欺诈检测、水军检测、金融风控、故障监测等实际场景。

#### 谱域视角下的图异常检测

本文首次尝试了从**谱域视角**分析图上的异常数据，并观察到：异常数据会导致频谱能量的 “右移”，即能量更少集中在低频，同时更多集中在高频。

当异常数据占比为 0% 时，大部分能量集中在低频部分（λ<0.5）。通过增大异常节点相对于正常节点的方差 σ 或比例 α，数据的异常程度逐渐增大，频谱上低频部分的能量逐渐变少，高频部分则相应增加。基于高斯分布假设，本文**从理论上严格证明了数据异常程度的增大和频谱能量的 “右移” 之间存在单调关系**。

在实际场景中，异常数据通常遵循更加复杂的分布。在四个大规模图异常检测数据集上，研究者同样证实了 “右移” 现象的存在。以下图亚马逊异常用户检测数据集为例，当删除数据中一部分异常节点后，频谱上低频能量显著增多，同时高频则相应减少。如果删除同样数量的随机节点，频谱的能量分布几乎没有变化。这进一步验证了异常数据是频谱能量 “右移” 的关键。

#### 图异常检测：Beta 小波

上节的分析表明，在图异常检测时需要关注 “右移” 效应。

遗憾的是，现有的图神经网络大多属于低通滤波器或者自适应滤波器，它们无法保证带通性质。其中自适应滤波器虽然具有拟合任意函数的能力，但在异常检测中同样可能退化为低通滤波器。这是因为在整个数据集中，异常数据对应的高频信息占比较小，而大部分频谱能量仍然集中在低频。

为了更好处理异常数据造成的 “右移”，研究者提出了一种图异常检测的新方法 ——**Beta 小波图神经网络 (BWGNN)**。通过借鉴 Hammond 图小波理论，他们基于 Beta 函数设计了新的小波核作为图神经网络的频谱滤波器。

相比于常用的热核 (Heat Kernel) 函数，Beta 函数作为小波核不仅符合带通滤波器的要求，还具有更好的频域局部性与空域局部性。