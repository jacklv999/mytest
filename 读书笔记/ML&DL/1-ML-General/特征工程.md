## 特征工程

#### 1.类automl的暴力特征字典思路

暴力特征字典指的是当给定数据，能在想象力范围能组合出尽可能多的特征，并形成Pipline，加快特征尝试和迭代的速度，就像automl一样。

打个比方，当给你两个类别特征A 和B，你能制造出多少个特征用于迭代？简单写十个

```text
count:A_COUNT、B_COUNT、A_B_COUNT
ratio: A_B_COUNT/A_COUNT 在A里各个B类所占的比例
most: A_most_B 在A类里出现最高的B是哪个
pivot: A_B1_count、A_B2_count A和B类里特定的B1、B2的联合统计
pivot2: A_B1_count-A_B2_count A的B1行为和B2行为的加减乘除
序列化：初步LDA，NMF，SVD，进一步Word2Vec，doc2vec 再进一步 图神经网络deepwalk，pPRoNE
```

如果再加上numeric、time、target特征，几乎可以组合成无穷无尽的特征

- **提升方法：**可以看各个数据挖掘的比赛获胜solution
- **缺陷：**这类会产生大量特征，自然也有大量无用特征，会降低模型质量和速度

#### 2.基于业务理解的特征工程思路

通过内在的业务逻辑去分做特征，可以先想业务逻辑，然后数据分析验证，也可以数据分析验证，然后得到业务逻辑，最大的好处是可解释性强，在此基础上泛化能力更强，而且模型规模小

- **提升方法：**通过努力的数据分析，以及多交流获取业务的内在逻辑形式。
    - 多加几个行业群，多看论文多交流，多逛论坛
- **缺陷：**凭借业务逻辑做特征，容易遗漏掉强特征。
    - 不能琢磨出全部逻辑，甚至主动的筛掉有价值的特征

#### 3.基于特征重要性表的特征工程思路

xgb/lgb可以输出特征重要性表，通过特征重要性表我们可以迅速在大量特征中获取强特征。在此基础上我们可以对强特征做更深层次的挖掘。

- 如果看到一个数值特征特征重要性很强，可以用类别特征和其交叉
- 如果一个统计特征很重要，可以增加一个时区维度，比如最近一周，最近一个月。
- 如果距离上次时间很重要，可以增加距离上两次，上次三次的时间特征。

进一步，特征重要性表也可以知道深度学习模型子结构的选择，序列特征对应rnn类，交叉特征对应fm类，文本特征对应nlp类，如果特征不重要，就不用上相应的结构了，如果重要，就可以对将特定的特征输入对应的子结构了。

- **提升方法：**经验的积累，如何将一个特征发散开来
- **缺陷：**首先得做出强特征，然后才能在强特征基础上发散

#### 4.类automl的暴力特征字典思路 对 基于业务理解的特征工程思路 的协助

前文说到，基于业务理解的特征工程容易遗漏特征，不能挖掘全部可能存在的业务逻辑。

那么我们可以先暴力特征字典全部罗列起来，然后在赋予其业务逻辑，看其在当前业务下是否有效。

再回到第一项的暴力特征字典。我们把category A和B替换成user ，item

```text
count:user_COUNT（用户活跃度）
ratio: user_item_COUNT/user_COUNT （某个商品在user购买中的比例，喜爱程度）
average:user_COUNT/user_nunqiue_item （平均每类商品的购买量）
most: user_most_item （用户最喜爱的品类）
pivot: user_item1_count、user_item2_count （用户和特定商品的交互）
pivot2: user_item1_count-user_item2_count （用户不同行为的差值，比如生活用品和娱乐用品的比例）
序列化：初步LDA，NMF，SVD（用商品描述用户画像）
```

总之，维护一个category、numeric、time、target组合特征字典，当想不到好的业务特征时候，可以从这些特征字典里找灵感。

#### 5.类automl的暴力特征字典思路 对 基于特征重要性表的特征工程思路 的协助

- 首先, 把原始 data去跑特征重要性表，知道某个category特征或numeric很重要，
- 然后, 进一步挖掘这个特征，用各种category，numeric特征去描述它

#### 6.基于业务理解的特征工程思路 和 基于特征重要性表的特征工程思路 对 类automl的暴力特征字典思路的协助

- 首先, 类automl的暴力特征字典产生无数的特征
- 然后, 清洗特征
    - 基于特征重要性表，删去特征重要性低的特征，
    - 基于业务理解，把明显无相关性的category交叉移除

这样就不会产生过多无用的特征变成噪音降低模型速度和精度

#### 7.基于业务理解的特征工程思路 和 基于特征重要性表的特征工程思路 的相互迭代

通过观察特征重要性表，思考背后真正的业务逻辑，找出真正和target直接相关的特征，既能提升对业务的理解，也能够提升模型的性能。

例如, 在Avito Demand Prediction Challenge（类似闲鱼的一个app转化预测）里，大家发现各种category_mean_price - price有很高的特征重要性，因此冠军little boat思考出这不就是合理价格和卖家出价的差影响转化率嘛，于是干脆先建了一个子模型，先预测出pred_price,然后用pred_price-price用于转化率模型，取得了更好的效果，这就是基于特征重要性来理解业务，深挖特征的一个好的案例。