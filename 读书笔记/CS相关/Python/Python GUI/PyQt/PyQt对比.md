## PyQt GUI对比

#### PyQt优势

对于桌面开发，天下武功那么多，PyQt 既是最正统的门派，同时又是一系列综合技术的组合:

- 进可以同 C++ Qt 无缝整合，解决性能相关的东西；
- 退又有基于 chromium 的 QtWebEngine ，可以用 html/js 来写页面，并和 python 双向调用，实现类似 cef/Electron 的效果，但 Electron 只能用 web 技术，不能 native 混合开发;
- 往左，QtWidgets 可以和传统 C# 的 WinForm pk;
- 往右，Qt-Quick 可以同 WPF/XAML 看齐。

PyQt 就是一扇门，它通往的是最专业的桌面解决方案的世界。

#### TK

- tk 的简单是缺胳膊丢大腿的简单，是 “不完整”, 很多控件缺失;
- 文档奇缺，方文档语焉不详，网上信息支离破碎;
- 天花板低，简单的小工具基本就是 Tkinter 的上限
- 机制简陋，大量主要操作全靠字符串传递，比如改变大小;

#### DirectUI

做桌面的都知道，每个操作系统都提供了一系列标准控件，按钮，输入框之类的，直接用就是写出那种最古坂的界面来，虽然可以重定义颜色，自定义 OnPaint 之类的绘制函数，但是限制是非常大的：

- 性能不高，每个按钮，Label 都是一个操作系统的 HWND 资源，控件多了性能不行。
- 各个操作系统标准控件不同，功能也不同，做跨平台依靠这些标准组件，就只砍功能作飞线。
- 灵活度太差了。

所以成品桌面软件，不管你们看到的 360/迅雷/QQ，都使用自己绘制自己做事件响应的方式，称为 DirectUI，只有最外层的大窗口用操作系统提供的标准组件，里面都是自己管理的，因此又称为 Windowless 的开发方式。

其中 Tkinter/wxPython 都是用的标准组件，同时他们为了跨平台保持一致性，还会舍弃很多平台独有的功能，而只有 Qt 是从最底层就使用 DirectUI 自己绘制的机制来实现界面的。

**事件机制**

比如我曾经想给 TextEdit 控件加个按 CTRL+回车 的事件，Tkinter 里就只有一个 bind 接口：

```python3
edit.bind('<Control-Enter>', self.on_hotkey_ctrl_enter)
```

没错，又是字符串问题，这里不提有多坑了，关键是这个机制问题，Tkinter 为了捕获键盘专门做了一个 bind，而 Qt 提供的是更灵活的消息重载、消息 filter 机制，让你可以处理所有消息，不当是键盘消息，同时还可以决定消息的流向，是否拦截。

PyQt 里还有 QAction 机制，可以让多个功能相同的控件（比如菜单里的保存，和工具条上的保存按钮）都指向一个相同的 QAction，再由这个 QAction 来绑定代码里的函数。而 Tkinter 或者 wxpython 里没有这个机制，你只能为这些事件绑定代码。

PyQt 的信号机制可以串联，可以将按钮的 clicked 信号直接连接到其他按钮的 click 槽上，或者连接到窗口的 close 上面，不用写代码 designer 里拖动一下就能设置很多关联事件。

**界面风格**

上面也说了，由于 Tkinter 和 wxpython 都是用操作系统提供的控件，因此风格很难改变，Tkinter 最丑，因为它只能改颜色，wxpython 好歹还提供了一个 OnPaint 事件，让你自己绘制，这样好歹可以做的稍微多样化一点，但是也和之前直接用 MFC 的 OnPaint 绘制界面一样，性能差，走的 GDI，界面稍微一复杂点，resize 一下就卡了。

OnPaint 还有一个问题是你只能做规则形状的控件，所有控件都必须是规则的矩形，想花哨点都没法，因为每次 OnPaint 进来就是让你绘制一个矩形区间，虽然可以用半透明模拟，但是性能太差了，最后代码和界面耦合度太高，全部搅在一起，换风格就要改代码。

那么 PyQt 使用 DirectUI 的机制获取了最大灵活度以后，它是如何解决的呢？PyQt 有从低到高各个层次的解决方法，其中最多的就是 QSS，一套类似 CSS 的机制.

并且 PyQt 内置了好几套默认风格，你要切换只需要简单的一句：

```python3
window.changeStyle("windows")
```

你就得到一个 windows xp 风格的界面

看起来和 Tkinter 一样丑？没事，继续

```python3
window.changeStyle("windowsvista")
```

立马变身 vista 风格：

不高兴你还可以把默认风格导出来，用 qss 编辑器修改微调，然后另存成别的风格。

**联动 Web**

商用桌面软件，一般主体界面，主要面板用 Qt/PyQt 开发，而对于一些经常变动的，比如活动抽奖页面之类的，排行榜之类天天变来变去，方便远程更新的，用 Web 页面更方便。

PyQt 4.x 的时候还在用 Webkit，到了 5.x 以后已经升级为更现代的基于 Chromium 的 QtWebEngine，你可以理解成一个小型的 cef/electron 了。

Python 可以通过 QWebChannel 注册一个函数给 javascript 调用，Python 也可以用 eval 来执行某个 javascript 函数，还可以共享各种数据，这样 js 可以专注页面，然后用 Python 来实现 native 功能。

**学习成本**

从头学起 Tkinter 一点不比 PyQt 简单，PyQt 接口更加清晰和现代，Tkinter 接口再众多 GUI 体系中可以用 “老旧”和 "古怪”，不像 PyQt 那么符合直觉，因此 Tkinter 写同样的功能要查更多的文档，最后，文档还十分稀缺。

另外是你花了很多时间学会了 Tkinter，突然有一天，你会碰到一个小需求，比如布局中窗口拉伸时想指定各个控件的拉伸比例，比如想给 combobox 里加个图片，你搜尽网上所有 Tkinter 的文档，你才发现 Tkinter 完全做不了，这样的事情一次两次以后，你就非常容易后悔当初选择了 Tkinter 了，因为同样的时间，你早学会 PyQt 两遍了。

三个界面比较方案，Tkinter 的天花板只有三层楼那么高，wxPython 有十层楼，而 PyQt 的天花板，上不封顶，它没有天花板。

因此既然学习成本类似，说实话 Tkinter 学习成本略高，wx 和 PyQt 类似，当然选择天花板最高的东西学。

**混合开发**

PyQt 可以无缝同 C++ Qt 整合，大部分界面可以用 PyQt 直接实现，少部分影响性能的地方，比如单独某个复杂窗口，或者带有特殊功能并且要显示几万行数据的 treeview，表格等，可以用 C++ 来实现，导出给 PyQt 调用。

要性能 C++ Qt 可以秒杀任何 Electron/C# 的解决方案，更别说 tk/wx 了。

论扩展能力，网上还有大量的 Qt 的开源控件，比如 Markdown Preview，PyQt 都可以直接拿过来用。

**为什么我没用 wxpython ？**

一句话就是我碰到 wxpython 的天花板了，说实话，wxpython 也能构造复杂的界面，当初我用 wxpython 给一款即时通信软件做过界面，然后，当我想要定制样式，由于缺乏 DirectUI 机制的灵活性，我只能在非常有限的条条框框下定义。

其实我的定制也没感用多复杂，就是给这个控件加个背景，给那个控件实现个 OnPaint 方法，然后当我试着拖动改变窗口大小，它卡了。

我以前用 MFC、C++ Builder 下面自己接管 OnPaint 的时候都很流畅啊，但为啥 wxpython 它就卡了呢？是不是我哪里没有用对？然后我研究了两个星期，试尽了所有方式，看完了相关的所有文档，性能有所提升，但是没有本质改善。

最后我终于意识到，我又碰到 wxpython 的天花板了。

**哪些项目用 PyQt 开发的？** 

- Eric Python IDE
- 音乐编辑软件：Frescobaldi
- 科学计算 IDE：Spyder
- 数据挖掘系统 Orange：

什么叫专业桌面软件？上面这些就是。

**为什么推荐 PyQt ?**

上手容易，天花板高，它并不比 tkinter/wxpython 难学，写起代码来也较前两者更为简单清晰，代码易读性和可维护性都比前两个强。前两者就像学打算盘，你学出来你就落伍了，而 PyQt 学会了，你可以在十年二十年内持续受益。

关键，PyQt 有海量的学习资料，只要走过弯路，被其他 GUI 系统坑过，并真的在正式产品里使用过 PyQt 你就会发现，投入学习 PyQt 的时间是完全值得的，这玩意儿学了你不吃亏，学了你不上当。

你不一定会从事专业桌面开发，但小到做点个人小玩具，给组内做点工具什么的，大到开发正式产品，同 C++ Qt 结合，它的天花板永远比你的需求要高。